<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StockPricePredictions — Shree Yantra Signals</title>
  <meta name="description" content="Vedic-themed stock predictor with live OHLC, autocomplete, and a global indices ticker." />

  <link rel="icon" type="image/png" href="logo.png" />
  <link rel="stylesheet" href="style.css" />
  <!-- Footer/Ticker overlap fix -->
  <link rel="stylesheet" href="fix.css" />

  <!-- Google AdSense (Auto Ads only) -->
  <meta name="google-adsense-account" content="ca-pub-6957786074161829" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6957786074161829" crossorigin="anonymous"></script>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="wrap header-row">
      <div class="brand">
        <img class="logo" src="logo.png" alt="Stock Price Predictions Logo" />
        <div>
          <h1>Shree Yantra <span>Stock Predictor</span></h1>
          <p class="tag">Vedic-inspired signals &bull; Real OHLC &bull; Free</p>
        </div>
      </div>
      <nav class="nav">
        <a href="index.html" aria-current="page">Home</a>
        <a href="about.html" target="_blank" rel="noopener">About</a>
        <a href="privacy.html" target="_blank" rel="noopener">Privacy</a>
        <a href="terms.html" target="_blank" rel="noopener">Terms</a>
        <a href="contact.html" target="_blank" rel="noopener">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="wrap">
    <section class="panel">
      <h2 class="hero-title">Find a stock. See today’s OHLC and a mystical hint for tomorrow.</h2>
      <p class="lede">Type a company or ticker to get live OHLC data and our Sree Yantra based next-day signal.</p>

      <div class="search-stack">
        <div class="row">
          <input id="ticker" placeholder="Type company or ticker (e.g., Tata Motors, RELIANCE.NS, AAPL)" />
          <button id="go" class="btn">Analyze</button>
        </div>
        <div id="suggestBox" class="suggest hidden" role="listbox" aria-label="Suggestions"></div>
      </div>

      <article id="card" class="card hidden" aria-live="polite">
        <header class="card-head">
          <h3 id="cTicker">-</h3>
          <div id="cSignal" class="chip">Awaiting...</div>
        </header>
        <div class="ohlc">
          <div class="kv"><span>Open</span><strong id="cOpen">-</strong></div>
          <div class="kv"><span>High</span><strong id="cHigh">-</strong></div>
          <div class="kv"><span>Low</span><strong id="cLow">-</strong></div>
          <div class="kv"><span>Close</span><strong id="cClose">-</strong></div>
        </div>
        <p class="pred-note" id="predNote">Prediction For Next Day: -</p>
      </article>
    </section>

    <!-- Added: Prediction widget (IDs are unique to avoid conflicts with your app) -->
    <section class="panel" style="margin-top:1.5rem">
      <h3>Quick Next-Day Prediction</h3>
      <div class="row">
        <input id="pn-symbol" placeholder="AAPL, TCS.NS, RELIANCE.NS" />
        <button id="pn-go" class="btn">Predict Next Close</button>
      </div>
      <div id="pn-result"></div>
    </section>
  </main>

  <!-- Global indices scrolling ribbon (above footer) -->
  <div class="ticker" aria-label="Global market ticker">
    <div class="wrap ticker-viewport">
      <div class="ticker-track" id="tickerTrack"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="wrap footer-content">
      <p>© 2025 StockPricePredictions.com &bull; Signals are informational only &bull; <a href="privacy.html" target="_blank" rel="noopener">Privacy</a></p>
      <div class="social-icons">
        <a href="#" target="_blank" rel="noopener" aria-label="Facebook"><img src="icons/facebook.svg" alt="Facebook"></a>
        <a href="#" target="_blank" rel="noopener" aria-label="Twitter"><img src="icons/twitter.svg" alt="Twitter"></a>
        <a href="#" target="_blank" rel="noopener" aria-label="Instagram"><img src="icons/instagram.svg" alt="Instagram"></a>
        <a href="#" target="_blank" rel="noopener" aria-label="LinkedIn"><img src="icons/linkedin.svg" alt="LinkedIn"></a>
        <a href="#" target="_blank" rel="noopener" aria-label="YouTube"><img src="icons/youtube.svg" alt="YouTube"></a>
      </div>
    </div>
  </footer>

  <!-- Your app config + code (unchanged so your existing site stays working) -->
  <script>window.API_BASE = "https://api.stockpricepredictions.com";</script>
  <script src="script.js"></script>

  <!-- Inline widget logic (uses Render API directly, no conflicts with your app) -->
  <script>
    (function(){
      const API = "https://stockpricepredictions-api.onrender.com"; // backend with /predict-next
      const input = document.getElementById('pn-symbol');
      const btn = document.getElementById('pn-go');
      const out = document.getElementById('pn-result');

      function fmt(v){
        if(v == null || Number.isNaN(v)) return '-';
        const n = Number(v);
        if(!Number.isFinite(n)) return String(v);
        return n.toLocaleString(undefined, { maximumFractionDigits: 2 });
      }

      async function fetchPrediction(sym){
        const url = API.replace(/\/$/, '') + "/predict-next?symbol=" + encodeURIComponent(sym);
        const res = await fetch(url, { mode: 'cors' });
        const text = await res.text();
        if(!res.ok){
          throw new Error("API " + res.status + ": " + text);
        }
        try { return JSON.parse(text); } catch { throw new Error("Non-JSON: " + text); }
      }

      function render(data){
        const p = data.prediction || {};
        const prev = data.previous_day || {};
        out.innerHTML = `
          <div class="card">
            <h4>Prediction for <strong>${p.target_date || '-'}</strong></h4>
            <div class="grid two">
              <div>
                <div class="muted">Based on previous day (OHLC) — ${prev.date || '-'}</div>
                <ul class="kv">
                  <li><span>Open</span><b>${fmt(prev.open)}</b></li>
                  <li><span>High</span><b>${fmt(prev.high)}</b></li>
                  <li><span>Low</span><b>${fmt(prev.low)}</b></li>
                  <li><span>Close</span><b>${fmt(prev.close)}</b></li>
                  <li><span>Volume</span><b>${fmt(prev.volume)}</b></li>
                </ul>
              </div>
              <div class="big-num">
                <div class="muted">Next-day predicted close</div>
                <div class="value">${fmt(p.predicted_close)}</div>
                <div class="muted tiny">Method: ${p.method || '-'}</div>
              </div>
            </div>
          </div>
        `;
      }

      async function run(){
        const sym = (input && input.value || "RELIANCE.NS").trim().toUpperCase();
        if(!sym){ out.textContent = "Enter a symbol"; return; }
        try{
          out.innerHTML = "<div class='muted'>Loading…</div>";
          const data = await fetchPrediction(sym);
          render(data);
        }catch(err){
          out.innerHTML = "<div class='card'>" + String(err.message) + "</div>";
        }
      }

      if(btn) btn.addEventListener('click', run);
      if(input) input.addEventListener('keydown', e => { if(e.key === 'Enter') run(); });
    })();
  </script>
</body>
</html>
